@rendermode InteractiveServer
@inject DatabaseContext DbContext
@inject NavigationManager NavigationManager

<div class="row g-0">
    <div class="col-md-12">
        <button class="btn btn-primary float-end" @onclick="ShowAddTrainer">
            Add Pokemon
        </button>
    </div>
</div>





 


@code {
    private List<Trainer>? pokemons;
    private EditContext editContext;
    private Trainer model;
    private bool showForm;

    private void ShowAddTrainer()
    {
        model = new Trainer();
        editContext = new EditContext(model);
        showForm = true;
    }

    private void Edit(Trainer trainer)
    {
        model = trainer;
        editContext = new EditContext(model);
        showForm = true;
    }

    private async Task Submit()
    {
        if (model.Id == 0)
            DbContext.Trainers.Add(model);
        else
            DbContext.Trainers.Update(model);

        await DbContext.SaveChangesAsync();
        await Refresh();
    }

    protected override async Task OnInitializedAsync()
    {
        await Refresh();
    }

    private async Task Refresh()
    {
        model = new Trainer();
        editContext = new EditContext(model);
        pokemons = await DbContext.Trainers.ToListAsync();
    }

    private async Task Delete(Trainer trainer)
    {
        DbContext.Trainers.Remove(trainer);
        await DbContext.SaveChangesAsync();
        await Refresh();
    }
}
